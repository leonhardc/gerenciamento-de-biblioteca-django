<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- TODO: mudar a linha abaico quando adicionar no django -->
    <link rel="stylesheet" href="./../../templates/static/bootstrap/css/bootstrap.css"> 
    <title>Cadastrar Autor</title>
    <style>
        .error {
            color: red; 
            font-size: 12px;
        }
    </style>
</head>
<body>
    <div class="container my-2">
        <!-- Formulário para adicionar Autor na base de dados -->
        <h4 class="text-center mb-4">Adicionar Autor</h4>
        <form id="form" class="px-4" action="" method="POST">
            
            <div class="row mb-2">
                <div class="col">
                    <label class="form-label" for="nome">Nome</label>
                    <input required class="form-control" type="text" id="nome" name="nome" placeholder="Nome do Autor">
                    <span id="erroNome" class="error"></span>
                </div>
                <div class="col">
                    <label class="form-label" for="cpf">CPF</label>
                    <input required class="form-control" type="text" id="cpf" name="cpf" placeholder="CPF do Autor" maxlength="11">
                    <span id="erroCPF" class="error"></span>
                </div>
            </div>

            <div class="row mb-2">
                <div class="col">
                    <label class="form-label" for="nacionalidade">Nacionalidade</label>
                    <input required class="form-control" type="text" id="nacionalidade" name="nacionalidade" placeholder="Nacionalidade do Autor">
                    <span id="erroNacionalidade" class="error"></span>
                </div>
                <div class="col"></div>
            </div>

            <div class="d-flex w-100 justify-content-center">
                <button class="btn btn-primary mt-3" type="submit" id="submit">Adicionar Autor</button>
            </div>
        </form>

        <script>
            // Validar campos do formulario

            var submitButton = document.querySelector("#submit")

            function validarNome() {
                // Verifica se o nome não contém números ou caracteres especiais
                const nome = document.querySelector('#nome')
                var erroNome = document.querySelector("#erroNome")
                if (/[@!#$%^&*()/\\0-9]/.test(nome.value)){
                    nome.style.borderColor = "red"
                    erroNome.textContent = "O nome do autor não pode conter números ou caracteres especiais."
                    submitButton.disabled = true
                }
                else {
                    nome.style.border = "var(--bs-border-width) solid var(--bs-border-color)"
                    erroNome.textContent = ""
                    submitButton.disabled = false
                }
            }

            function validarCPF() {
                // Verifica se ha letras ou caracteres especiais no CPF.
                // Verifica se o CPF tem 11 caracteres
                const cpf = document.querySelector('#cpf')
                var erroCPF = document.querySelector("#erroCPF")

                if (isNaN(cpf.value)) {
                    nome.style.borderColor = "red"
                    erroCPF.textContent = "O CPF não pode conter letras ou caracteres especiais."
                    submitButton.disabled = true
                }
                else if (cpf.value.length != 11) {
                    if (erroCPF.textContent != "") {
                        cpf.style.borderColor = "red"
                        erroCPF.textContent = "\nO CPF deve conter 11 caracteres."
                        submitButton.disabled = true
                    }
                    else {
                        cpf.style.borderColor = "red"
                        erroCPF.textContent = "O CPF deve conter 11 caracteres."
                        submitButton.disabled = true
                    }
                }
                else {
                    cpf.style.border = "var(--bs-border-width) solid var(--bs-border-color)"
                    erroCPF.textContent = ""
                    submitButton.disabled = false
                }
            }

            function validadeNacionalidade() {
                // Verifica se o campo nacionalidade contém numeros ou caracteres especiais
                var nacionalidade = document.querySelector('#nacionalidade')

                var erroNacionalidade = document.querySelector("#erroNacionalidade")
                if (/[@!#$%^&*()/\\0-9]/.test(nacionalidade.value)){
                    nacionalidade.style.borderColor = "red"
                    erroNacionalidade.textContent = "A nacionalidade não pode conter números ou caracteres especiais."
                    submitButton.disabled = true
                }
                else {
                    nacionalidade.style.border = "var(--bs-border-width) solid var(--bs-border-color)"
                    erroNacionalidade.textContent = ""
                    submitButton.disabled = false
                }
            }

            document.querySelector('#nome').addEventListener('keyup', validarNome)
            document.querySelector('#cpf').addEventListener('keyup', validarCPF)
            document.querySelector('#nacionalidade').addEventListener('keyup', validadeNacionalidade)

        </script>
    </div>
</body>
</html>